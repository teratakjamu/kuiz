<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuiz: Adakah Badan Anda Bersedia Untuk Menimang Cahaya Mata?</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        /* Custom styles for smoother transitions */
        .button-shadow {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
        }
        .button-hover:hover {
            transform: scale(1.02); /* Slightly less aggressive scale for general buttons */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 min-h-screen flex flex-col items-center justify-center p-4">

    <div id="root" class="w-full max-w-md mx-auto flex-grow">
        <!-- React app will be rendered here -->
    </div>

    <!-- React and ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>


    <script type="text/babel">
        // TEMPATKAN URL GOOGLE FORM DAN ID INPUT ANDA DI SINI
        // Sila PASTIkan nilai-nilai ini TEPAT 100% menggunakan kaedah "Inspect Element" yang diterangkan di atas.
        const GOOGLE_FORM_ACTION_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdettwqhWDq-40Z8j2CcSp4pJa3vN2gHk68OAO_6PZLfJ2xtw/formResponse";
        const GOOGLE_FORM_NAME_FIELD_ID = "entry.802902389";
        const GOOGLE_FORM_PHONE_FIELD_ID = "entry.631499256";
        const GOOGLE_FORM_GENDER_FIELD_ID = "entry.1916375168"; // Untuk medan 'Jantina'
        const GOOGLE_FORM_ANSWERS_FIELD_ID = "entry.497349643"; // Untuk medan 'Jawapan Kuiz'

        // Main App component
        const App = () => {
          const [gender, setGender] = React.useState(null); // 'male' or 'female'
          const [currentQuestionIndex, setCurrentQuestionIndex] = React.useState(0);
          const [answers, setAnswers] = React.useState({});
          const [showResult, setShowResult] = React.useState(false);

          // State for lead collection
          const [leadName, setLeadName] = React.useState('');
          const [leadPhone, setLeadPhone] = React.useState('');
          const [isSendingData, setIsSendingData] = React.useState(false); // New state for visual feedback
          // Menggunakan useRef untuk mengesan sama ada data telah dihantar untuk elak penghantaran berulang
          const hasSentLeadToGoogleFormRef = React.useRef(false); 

          // Define questions for female
          const femaleQuestions = [
            {
              id: 'female_q1',
              question: 'Berapakah umur anda?',
              options: [
                { text: 'Bawah 25 tahun', value: 'A' },
                { text: '25-34 tahun', value: 'B' },
                { text: '35-39 tahun', value: 'C' },
                { text: '40 tahun ke atas', value: 'D' },
              ],
            },
            {
              id: 'female_q2',
              question: 'Kitaran Haid Anda:',
              options: [
                { text: 'Sangat teratur (setiap 21-35 hari)', value: 'A' },
                { text: 'Agak teratur tetapi ada sedikit variasi', value: 'B' },
                { text: 'Tidak teratur atau jarang datang', value: 'C' },
                { text: 'Tiada haid', value: 'D' },
              ],
            },
            {
              id: 'female_q3',
              question: 'Berat Badan Anda:',
              options: [
                { text: 'Dalam julat BMI yang sihat (18.5-24.9)', value: 'A' },
                { text: 'Kurang berat badan', value: 'B' },
                { text: 'Berat badan berlebihan', value: 'C' },
                { text: 'Obes', value: 'D' },
              ],
            },
            {
              id: 'female_q4',
              question: 'Pengambilan Asid Folik:',
              options: [
                { text: 'Saya mengambil suplemen asid folik setiap hari sekurang-kurangnya 3 bulan sebelum merancang hamil.', value: 'A' },
                { text: 'Saya mengambil asid folik tetapi tidak setiap hari atau tidak cukup lama.', value: 'B' },
                { text: 'Saya tidak mengambil asid folik.', value: 'C' },
              ],
            },
            {
              id: 'female_q5',
              question: 'Tahap Tekanan (Stres) Anda:',
              options: [
                { text: 'Saya dapat menguruskan tekanan dengan baik dan jarang merasa tertekan.', value: 'A' },
                { text: 'Saya kadang-kadang merasa tertekan tetapi dapat mengatasinya.', value: 'B' },
                { text: 'Saya sering merasa tertekan dan sukar untuk menguruskannya.', value: 'C' },
              ],
            },
            {
              id: 'female_q6',
              question: 'Tabiat Pemakanan Anda:',
              options: [
                { text: 'Saya mengamalkan diet yang seimbang dan sihat (banyak buah, sayur, bijirin penuh).', value: 'A' },
                { text: 'Saya cuba makan sihat tetapi kadang-kadang tersasar.', value: 'B' },
                { text: 'Pemakanan saya kurang sihat (banyak makanan segera, bergula).', value: 'C' },
              ],
            },
            {
              id: 'female_q7',
              question: 'Tabiat Merokok/Vape:',
              options: [
                { text: 'Saya tidak merokok atau vape.', value: 'A' },
                { text: 'Saya pernah merokok/vape tetapi telah berhenti.', value: 'B' },
                { text: 'Saya masih merokok atau vape.', value: 'C' },
              ],
            },
            {
              id: 'female_q8',
              question: 'Pengambilan Alkohol:',
              options: [
                { text: 'Saya tidak mengambil alkohol sama sekali.', value: 'A' },
                { text: 'Saya mengambil alkohol sesekali tetapi dalam kuantiti yang sangat sedikit.', value: 'B' },
                { text: 'Saya kerap mengambil alkohol.', value: 'C' },
              ],
            },
            {
              id: 'female_q9',
              question: 'Tahap Aktiviti Fizikal:',
              options: [
                { text: 'Saya aktif secara fizikal (bersenam sekurang-kurangnya 30 minit, 3-5 kali seminggu).', value: 'A' },
                { text: 'Saya aktif tetapi tidak konsisten.', value: 'B' },
                { text: 'Saya kurang aktif secara fizikal.', value: 'C' },
              ],
            },
            {
              id: 'female_q10',
              question: 'Sejarah Penyakit Kronik (contoh: diabetes, tiroid, PCOS):',
              options: [
                { text: 'Saya tiada penyakit kronik yang didiagnosis.', value: 'A' },
                { text: 'Saya ada penyakit kronik tetapi terkawal dengan baik melalui rawatan.', value: 'B' },
                { text: 'Saya ada penyakit kronik yang belum terkawal atau tidak dirawat.', value: 'C' },
              ],
            },
            {
              id: 'female_q11',
              question: 'Kesihatan Gigi dan Mulut:',
              options: [
                { text: 'Saya menjaga kebersihan gigi dan mulut dengan baik dan kerap berjumpa doktor gigi.', value: 'A' },
                { text: 'Saya menjaga kebersihan tetapi tidak kerap berjumpa doktor gigi.', value: 'B' },
                { text: 'Saya kurang memberi perhatian kepada kesihatan gigi dan mulut.', value: 'C' },
              ],
            },
          ];

          // Define questions for male
          const maleQuestions = [
            {
              id: 'male_q1',
              question: 'Berapakah umur anda?',
              options: [
                { text: 'Bawah 25 tahun', value: 'A' },
                { text: '25-34 tahun', value: 'B' },
                { text: '35-39 tahun', value: 'C' },
                { text: '40 tahun ke atas', value: 'D' },
              ],
            },
            {
              id: 'male_q2',
              question: 'Tabiat Merokok/Vape:',
              options: [
                { text: 'Saya tidak merokok atau vape.', value: 'A' },
                { text: 'Saya pernah merokok/vape tetapi telah berhenti.', value: 'B' },
                { text: 'Saya masih merokok atau vape.', value: 'C' },
              ],
            },
            {
              id: 'male_q3',
              question: 'Pengambilan Alkohol:',
              options: [
                { text: 'Saya tidak mengambil alkohol sama sekali.', value: 'A' },
                { text: 'Saya mengambil alkohol sesekali tetapi dalam kuantiti yang sederhana.', value: 'B' },
                { text: 'Saya kerap mengambil alkohol.', value: 'C' },
              ],
            },
            {
              id: 'male_q4',
              question: 'Tahap Tekanan (Stres) Anda:',
              options: [
                { text: 'Saya dapat menguruskan tekanan dengan baik dan jarang merasa tertekan.', value: 'A' },
                { text: 'Saya kadang-kadang merasa tertekan tetapi dapat mengatasinya.', value: 'B' },
                { text: 'Saya sering merasa tertekan dan sukar untuk menguruskannya.', value: 'C' },
              ],
            },
            {
              id: 'male_q5',
              question: 'Berat Badan Anda:',
              options: [
                { text: 'Dalam julat BMI yang sihat (18.5-24.9)', value: 'A' },
                { text: 'Kurang berat badan', value: 'B' },
                { text: 'Berat badan berlebihan', value: 'C' },
                { text: 'Obes', value: 'D' },
              ],
            },
            {
              id: 'male_q6',
              question: 'Tabiat Pemakanan Anda:',
              options: [
                { text: 'Saya mengamalkan diet yang seimbang dan sihat (banyak buah, sayur, bijirin penuh).', value: 'A' },
                { text: 'Saya cuba makan sihat tetapi kadang-kadang tersasar.', value: 'B' },
                { text: 'Pemakanan saya kurang sihat (banyak makanan segera, bergula).', value: 'C' },
              ],
            },
            {
              id: 'male_q7',
              question: 'Tahap Aktiviti Fizikal:',
              options: [
                { text: 'Saya aktif secara fizikal (bersenam sekurang-kurangnya 30 minit, 3-5 kali seminggu).', value: 'A' },
                { text: 'Saya aktif tetapi tidak konsisten.', value: 'B' },
                { text: 'Saya kurang aktif secara fizikal.', value: 'C' },
              ],
            },
            {
              id: 'male_q8',
              question: 'Pendedahan kepada Haba Tinggi (contoh: mandi air panas, sauna, kerja yang terdedah haba):',
              options: [
                { text: 'Saya jarang terdedah kepada haba tinggi.', value: 'A' },
                { text: 'Saya kadang-kadang terdedah tetapi cuba mengelakkannya.', value: 'B' },
                { text: 'Saya kerap terdedah kepada haba tinggi.', value: 'C' },
              ],
            },
            {
              id: 'male_q9',
              question: 'Penggunaan Seluar Dalam Ketat:',
              options: [
                { text: 'Saya mengelak memakai seluar dalam yang terlalu ketat.', value: 'A' },
                { text: 'Saya kadang-kadang memakai tetapi tidak selalu.', value: 'B' },
                { text: 'Saya kerap memakai seluar dalam yang ketat.', value: 'C' },
              ],
            },
            {
              id: 'male_q10',
              question: 'Sejarah Penyakit Kronik atau Masalah Reproduktif (contoh: diabetes, penyakit tiroid, masalah buah zakar):',
              options: [
                { text: 'Saya tiada penyakit kronik atau masalah reproduktif yang didiagnosis.', value: 'A' },
                { text: 'Saya ada penyakit kronik tetapi terkawal dengan baik.', value: 'B' },
                { text: 'Saya ada penyakit kronik/masalah reproduktif yang belum terkawal atau tidak dirawat.', value: 'C' },
              ],
            },
            {
              id: 'male_q11',
              question: 'Pendedahan kepada Bahan Kimia Berbahaya/Pencemaran:',
              options: [
                { text: 'Saya tidak terdedah kepada bahan kimia berbahaya.', value: 'A' },
                { text: 'Saya kadang-kadang terdedah tetapi mengambil langkah perlindungan.', value: 'B' },
                { text: 'Saya kerap terdedah kepada bahan kimia berbahaya di tempat kerja atau persekitaran.', value: 'C' },
              ],
            },
          ];

          const currentQuestions = gender === 'female' ? femaleQuestions : maleQuestions;
          const totalQuestions = currentQuestions.length;

          // Handle selection of gender
          const handleGenderSelect = (selectedGender) => {
            setGender(selectedGender);
            setCurrentQuestionIndex(0); // Reset for new quiz
            setAnswers({}); // Clear previous answers
            setShowResult(false); // Hide result
            setLeadName(''); // Clear lead name
            setLeadPhone(''); // Clear lead phone
            hasSentLeadToGoogleFormRef.current = false; // Reset submission status
            setIsSendingData(false); // Reset sending data status
          };

          // Handle user's answer to a question
          const handleAnswer = (questionId, value) => {
            setAnswers((prevAnswers) => ({
              ...prevAnswers,
              [questionId]: value,
            }));
          };

          // Move to the next question or show results
          const nextQuestion = () => {
            if (currentQuestionIndex < totalQuestions - 1) {
              setCurrentQuestionIndex(currentQuestionIndex + 1);
            } else {
              setShowResult(true); // All questions answered, show results
            }
          };

          // Function to send data to Google Form using a hidden iframe
          // Menggunakan useCallback untuk memastikan fungsi ini stabil dan tidak menyebabkan render berlebihan
          const sendLeadToGoogleForm = React.useCallback(async (name, phone, quizGender, quizAnswers) => {
            if (!GOOGLE_FORM_ACTION_URL || !GOOGLE_FORM_NAME_FIELD_ID || !GOOGLE_FORM_PHONE_FIELD_ID) {
                console.error("Google Form configuration is missing. Please update the GOOGLE_FORM_... constants in the code.");
                return;
            }

            // Elak penghantaran jika tiada data atau sudah dihantar untuk sesi ini
            if ((name.trim() === '' && phone.trim() === '') || hasSentLeadToGoogleFormRef.current) {
                return;
            }
            
            console.log("Attempting to send lead data to Google Form:", { name, phone, quizGender, quizAnswers });
            setIsSendingData(true); // Tunjukkan feedback visual

            // Buat iframe tersembunyi
            const iframe = document.createElement('iframe');
            iframe.name = 'googleFormTarget';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);

            // Buat form sementara
            const form = document.createElement('form');
            form.action = GOOGLE_FORM_ACTION_URL;
            form.method = 'POST';
            form.target = 'googleFormTarget'; // Sasarkan iframe tersembunyi
            form.style.display = 'none'; 

            // Tambah hidden input fields
            const addHiddenField = (name, value) => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = name;
                input.value = value;
                form.appendChild(input);
            };

            addHiddenField(GOOGLE_FORM_NAME_FIELD_ID, name.trim());
            addHiddenField(GOOGLE_FORM_PHONE_FIELD_ID, phone.trim());

            if (GOOGLE_FORM_GENDER_FIELD_ID) {
                addHiddenField(GOOGLE_FORM_GENDER_FIELD_ID, quizGender);
            }
            if (GOOGLE_FORM_ANSWERS_FIELD_ID) {
                addHiddenField(GOOGLE_FORM_ANSWERS_FIELD_ID, JSON.stringify(quizAnswers)); // Stringify objek kompleks
            }

            document.body.appendChild(form); // Tambah form ke body sementara

            // Hantar form
            form.submit();

            // Bersihkan form dan iframe selepas beberapa ketika
            setTimeout(() => {
                form.remove();
                iframe.remove();
                console.log("Hidden Google Form submission initiated. Check your Google Sheet.");
                hasSentLeadToGoogleFormRef.current = true; // Tandakan sudah dihantar untuk sesi ini
                setIsSendingData(false); // Sembunyikan feedback visual
            }, 2000); // Beri masa 2 saat untuk penghantaran
          }, [gender, answers]); // Bergantung pada gender dan answers yang merupakan sebahagian daripada payload

          // Effect untuk mencetuskan penghantaran Google Form apabila pengguna mengisi kedua-dua medan dan lepas fokus
          React.useEffect(() => {
              // Reset status penghantaran jika nama/telefon bertukar selepas dihantar
              // Ini memastikan jika pengguna menukar input selepas submit, ia boleh cuba submit semula
              if (showResult && hasSentLeadToGoogleFormRef.current && (leadName.trim() === '' || leadPhone.trim() === '')) {
                  hasSentLeadToGoogleFormRef.current = false;
              }
          }, [leadName, leadPhone]); // Pantau perubahan pada nama dan telefon untuk tujuan reset

          // Calculate the quiz result based on answers
          const calculateResult = () => {
            let score = 0;
            let consultationMessage = '';

            // Scoring logic: A = 3 points, B = 2 points, C/D = 1 point
            const calculateScore = (answerValue) => {
              if (answerValue === 'A') return 3;
              if (answerValue === 'B') return 2;
              return 1; // For C and D
            };

            // Evaluate answers
            Object.keys(answers).forEach((questionId) => {
              score += calculateScore(answers[questionId]);
            });

            // Determine consultation message based on gender and score/specific answers
            if (gender === 'female') {
              const ageAnswer = answers['female_q1'];
              const cycleAnswer = answers['female_q2'];
              const weightAnswer = answers['female_q3'];
              const folicAcidAnswer = answers['female_q4'];
              const smokingAnswer = answers['female_q7'];
              const alcoholAnswer = answers['female_q8'];
              const chronicDiseaseAnswer = answers['female_q10'];

              if (score >= (totalQuestions * 2.5) && smokingAnswer === 'A' && alcoholAnswer === 'A' && chronicDiseaseAnswer === 'A') {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-green-700 mb-2">Tahniah!</h3>
                    <p className="mb-4">
                      Anda menunjukkan kesediaan fizikal yang baik untuk hamil. Umur anda, kitaran haid yang teratur, gaya hidup sihat, dan pengambilan asid folik yang konsisten adalah petanda positif. Teruskan usaha anda dan jangan lupa untuk terus menjaga kesihatan secara menyeluruh. Jika anda belum berbuat demikian, pertimbangkan untuk berbincang dengan doktor anda untuk pemeriksaan pra-kehamilan yang lengkap.
                    </p>
                  </>
                );
              } else if (score >= (totalQuestions * 1.5) && score < (totalQuestions * 2.5)) {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-yellow-700 mb-2">Anda di Landasan yang Betul!</h3>
                    <p className="mb-4">
                      Terdapat beberapa aspek yang boleh anda perbaiki untuk meningkatkan kesediaan badan anda. Cuba untuk lebih konsisten dalam pengambilan asid folik dan pastikan pengurusan stres anda lebih teratur. Sedikit perubahan dalam gaya hidup boleh membuat perbezaan besar. Berundinglah dengan doktor untuk nasihat lebih lanjut dan pelan tindakan yang sesuai. **Sebagai alternatif, anda boleh cuba berikhtiar dengan produk kami iaitu Teh Uncang Buah Zuriat, produk 100% natural untuk meningkatkan potensi kehamilan.**
                    </p>
                  </>
                );
              } else {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-red-700 mb-2">Perhatian Diperlukan!</h3>
                    <p className="mb-4">
                      Berdasarkan jawapan anda, terdapat beberapa cabaran yang mungkin perlu ditangani sebelum atau semasa berusaha untuk hamil. Faktor umur, kitaran haid yang tidak teratur, masalah berat badan, atau tabiat tidak sihat seperti merokok/vape dan pengambilan alkohol boleh mempengaruhi kesuburan dan kehamilan. Adalah sangat disyorkan agar anda{' '}
                      <strong className="text-red-800">berjumpa dengan doktor atau pakar kesuburan secepat mungkin</strong> untuk penilaian menyeluruh dan pelan rawatan yang sesuai. Mereka boleh membantu mengenal pasti punca dan menawarkan penyelesaian terbaik untuk anda. **Sebagai alternatif, anda boleh cuba berikhtiar dengan produk kami iaitu Teh Uncang Buah Zuriat, produk 100% natural untuk meningkatkan potensi kehamilan.**
                    </p>
                  </>
                );
              }
            } else if (gender === 'male') {
              const ageAnswer = answers['male_q1'];
              const smokingAnswer = answers['male_q2'];
              const alcoholAnswer = answers['male_q3'];
              const hotExposureAnswer = answers['male_q8'];
              const tightUnderwearAnswer = answers['male_q9'];
              const chronicDiseaseAnswer = answers['male_q10'];

              if (score >= (totalQuestions * 2.5) && smokingAnswer === 'A' && alcoholAnswer === 'A' && hotExposureAnswer === 'A' && tightUnderwearAnswer === 'A' && chronicDiseaseAnswer === 'A') {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-green-700 mb-2">Hebat!</h3>
                    <p className="mb-4">
                      Anda menunjukkan kesediaan fizikal yang sangat baik untuk menyokong proses kehamilan. Umur anda, gaya hidup sihat, mengelakkan rokok/vape dan alkohol, serta pengurusan stres yang baik adalah faktor penting untuk kesuburan lelaki. Teruskan amalan positif ini. Jika anda belum berbuat demikian, pertimbangkan untuk berbincang dengan doktor anda untuk pemeriksaan kesihatan umum.
                    </p>
                  </>
                );
              } else if (score >= (totalQuestions * 1.5) && score < (totalQuestions * 2.5)) {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-yellow-700 mb-2">Anda di Laluan yang Baik!</h3>
                    <p className="mb-4">
                      Terdapat ruang untuk penambahbaikan bagi meningkatkan kesuburan anda. Pertimbangkan untuk mengurangkan pendedahan kepada haba tinggi dan mengamalkan pemakaian seluar dalam yang lebih longgar. Sedikit perubahan dalam gaya hidup boleh memberi impak positif. Dapatkan nasihat daripada doktor untuk panduan yang lebih spesifik. **Sebagai alternatif, anda boleh cuba berikhtiar dengan produk kami iaitu Teh Uncang Buah Zuriat, produk 100% natural untuk meningkatkan potensi kehamilan.**
                    </p>
                  </>
                );
              } else {
                consultationMessage = (
                  <>
                    <h3 className="text-xl font-semibold text-red-700 mb-2">Perhatian Diperlukan!</h3>
                    <p className="mb-4">
                      Berdasarkan jawapan anda, terdapat beberapa faktor yang mungkin mempengaruhi kesuburan anda. Faktor umur, tabiat seperti merokok/vape, pengambilan alkohol yang berlebihan, pendedahan kepada haba tinggi atau bahan kimia berbahaya, dan masalah berat badan boleh memberi kesan negatif kepada kualiti sperma. Adalah sangat disyorkan agar anda{' '}
                      <strong className="text-red-800">berjumpa dengan doktor atau pakar kesuburan secepat mungkin</strong> untuk penilaian menyeluruh. Mereka boleh membantu mengenal pasti punca dan menawarkan strategi untuk meningkatkan kesuburan anda. **Sebagai alternatif, anda boleh cuba berikhtiar dengan produk kami iaitu Teh Uncang Buah Zuriat, produk 100% natural untuk meningkatkan potensi kehamilan.**
                    </p>
                  </>
                );
              }
            }

            return consultationMessage;
          };

          // Component to display a single question
          const Question = ({ question, options, onAnswer, currentAnswer, questionNumber, totalQuestions }) => {
            return (
              <div className="bg-white p-6 rounded-xl shadow-lg w-full max-w-md mx-auto">
                <div className="text-sm text-gray-500 mb-4 text-center">
                  Soalan {questionNumber} / {totalQuestions}
                </div>
                <h2 className="text-xl font-semibold text-gray-800 mb-6 text-center">{question}</h2>
                <div className="flex flex-col space-y-3">
                  {options.map((option) => (
                    <button
                      key={option.value}
                      className={`py-3 px-4 rounded-lg text-left transition-all duration-200 ease-in-out
                        ${currentAnswer === option.value
                          ? 'bg-blue-600 text-white shadow-md'
                          : 'bg-blue-100 text-blue-800 hover:bg-blue-200 hover:shadow-sm'
                        } button-hover`}
                      onClick={() => onAnswer(option.value)}
                    >
                      <span className="font-medium mr-2">({option.value})</span> {option.text}
                    </button>
                  ))}
                </div>
              </div>
            );
          };

          // Component to display quiz results
          const Result = ({ gender, consultationMessage, onRestart, leadName, setLeadName, leadPhone, setLeadPhone, answers, isSendingData, sendLeadToGoogleForm }) => {
            const baseWhatsappPretext = "Saya dah jawab kuiz dan nak cuba berikhtiar dgn Teh Uncang Buah Zuriat.";
            // Append name and phone if provided
            const fullWhatsappPretext = `${baseWhatsappPretext}${leadName ? ` Nama: ${leadName}` : ''}${leadPhone ? ` No. Telefon: ${leadPhone}` : ''}`;
            const whatsappLink = `https://wa.me/60136406474?text=${encodeURIComponent(fullWhatsappPretext)}`;
            
            return (
              <div className="bg-white p-8 rounded-xl shadow-lg w-full max-w-md mx-auto text-center">
                <h2 className="text-2xl font-bold text-gray-800 mb-6">Hasil Kuiz Anda</h2>
                <div className="text-gray-700 text-left mb-6">
                  {consultationMessage}
                </div>
                <p className="text-sm text-gray-600 mb-6">
                  Peringatan penting: Kuiz ini adalah alat saringan awal sahaja dan{' '}
                  <strong className="text-gray-800">bukan diagnosis perubatan</strong>. Untuk nasihat dan penilaian kesuburan yang tepat, sila{' '}
                  <strong className="text-gray-800">berunding dengan doktor atau pakar kesuburan</strong> anda.
                </p>

                {/* Lead Collection Form */}
                <div className="mt-8 mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <p className="text-md font-semibold text-gray-700 mb-3">
                        Dapatkan Khidmat Nasihat Peribadi!
                    </p>
                    <p className="text-sm text-gray-600 mb-4">
                        Masukkan nama & nombor telefon anda di bawah untuk kami hubungi dan berikan panduan lebih lanjut.
                    </p>
                    <div className="mb-4">
                        <input
                            type="text"
                            placeholder="Nama Penuh Anda"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200"
                            value={leadName}
                            onChange={(e) => setLeadName(e.target.value)}
                            // Panggil sendLeadToGoogleForm apabila nama diubah dan medan telefon juga ada isi
                            onBlur={() => { 
                                if (leadName.trim() !== '' && leadPhone.trim() !== '') {
                                    sendLeadToGoogleForm(leadName, leadPhone, gender, answers);
                                }
                            }}
                        />
                    </div>
                    <div className="mb-4">
                        <input
                            type="tel"
                            placeholder="Nombor Telefon (cth: 0123456789)"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-200"
                            value={leadPhone}
                            onChange={(e) => setLeadPhone(e.target.value)}
                            // Panggil sendLeadToGoogleForm apabila nombor telefon diubah dan medan nama juga ada isi
                            onBlur={() => {
                                if (leadName.trim() !== '' && leadPhone.trim() !== '') {
                                    sendLeadToGoogleForm(leadName, leadPhone, gender, answers);
                                }
                            }}
                        />
                    </div>
                    {isSendingData && (
                        <p className="text-sm text-blue-600 font-medium mt-2">
                            Data anda sedang dihantar... (sila tunggu seketika)
                        </p>
                    )}
                </div>

                <a
                  href={whatsappLink}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="inline-block bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 button-shadow"
                >
                  <svg className="inline-block w-5 h-5 mr-2 -mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M.057 24l1.687-6.163c-1.041-1.804-1.6-3.807-1.6-5.87 0-6.592 5.306-11.97 11.856-11.97 3.242 0 6.301 1.256 8.653 3.537 2.353 2.28 3.567 5.236 3.567 8.232 0 6.592-5.306 11.97-11.856 11.97-1.954 0-3.876-.566-5.538-1.616l-6.02 1.661zm11.856-23.364c-5.822 0-10.536 4.67-10.536 10.457 0 1.955.578 3.843 1.638 5.485l-1.04 3.821 3.916-1.026c1.554.957 3.327 1.464 5.146 1.464 5.822 0 10.536-4.67 10.536-10.457s-4.714-10.457-10.536-10.457zm5.283 7.648c-.287-.13-.757-.369-.877-.41s-.205-.13-.29-.13c-.09 0-.23.034-.36.164-.13.13-.503.486-.615.584-.11.099-.22.13-.404.045-.184-.084-.775-.285-1.478-.91-.54-.485-.904-.812-1.015-1.002-.112-.19-.012-.175.083-.277.087-.099.199-.258.267-.387.069-.129.092-.22.066-.41s-.1-.387-.045-.584c.056-.196.3-.486.409-.645.112-.159.155-.275.23-.41.077-.135.039-.255-.02-.37-.06-.115-.29-.275-.745-.6-.454-.325-.879-.475-1.229-.475-.35 0-.64.034-1.024.13-.385.097-1.004.409-1.459.834-.45.427-.72.824-.875 1.404-.15.58-.02 1.107.399 1.794.399.687.765 1.399 1.545 2.124 1.05.999 1.928 1.349 2.628 1.879.314.237.575.427.766.566.29.213.467.29.636.255.17-.035.5-.213 1.01-.693.51-.48.835-.91 1.01-.122.175.786.175 1.455.175z"/>
                  </svg>
                  Dapatkan Khidmat Nasihat & Produk Ikhtiar Hamil
                </a>
                <button
                  onClick={onRestart}
                  className="mt-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105"
                >
                  Mula Kuiz Semula
                </button>
              </div>
            );
          };

          // Render the App component into the 'root' div
          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-100 to-purple-100 flex flex-col items-center justify-center p-4 font-inter">
              {/* This style is already in the <head> but kept here for React component isolation if needed */}
              <style>{`body { font-family: 'Inter', sans-serif; }`}</style>

              {!gender ? (
                // Gender selection screen
                <div className="bg-white p-8 rounded-xl shadow-lg w-full max-w-md mx-auto text-center">
                  <h1 className="text-3xl font-bold text-gray-800 mb-6">
                    Kuiz: Adakah Badan Anda Bersedia Untuk Menimang Cahaya Mata?
                  </h1>
                  <p className="text-gray-600 mb-8">
                    Kuiz ini direka khas untuk pasangan yang sedang berusaha untuk hamil. Jawapan anda akan membantu kami memberikan panduan awal mengenai kesediaan fizikal anda.
                  </p>
                  <div className="flex flex-col space-y-4">
                    <button
                      className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 button-shadow"
                      onClick={() => handleGenderSelect('female')}
                    >
                      Saya Seorang Wanita
                    </button>
                    <button
                      className="bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 button-shadow"
                      onClick={() => handleGenderSelect('male')}
                    >
                      Saya Seorang Lelaki
                    </button>
                  </div>
                </div>
              ) : showResult ? (
                // Show quiz results
                <Result
                  gender={gender}
                  consultationMessage={calculateResult()}
                  onRestart={() => {
                    setGender(null);
                    setCurrentQuestionIndex(0);
                    setAnswers({});
                    setShowResult(false);
                    setLeadName('');
                    setLeadPhone('');
                    hasSentLeadToGoogleFormRef.current = false; // Reset on restart
                    setIsSendingData(false); // Reset on restart
                  }}
                  leadName={leadName}
                  setLeadName={setLeadName}
                  leadPhone={leadPhone}
                  setLeadPhone={setLeadPhone}
                  answers={answers} // Pass answers to Result for saving
                  isSendingData={isSendingData} // Pass sending status
                  sendLeadToGoogleForm={sendLeadToGoogleForm} // Pass the function down
                />
              ) : (
                // Show current question
                <div className="w-full max-w-md">
                  <Question
                    question={currentQuestions[currentQuestionIndex].question}
                    options={currentQuestions[currentQuestionIndex].options}
                    onAnswer={(value) => handleAnswer(currentQuestions[currentQuestionIndex].id, value)}
                    currentAnswer={answers[currentQuestions[currentQuestionIndex].id]}
                    questionNumber={currentQuestionIndex + 1}
                    totalQuestions={totalQuestions}
                  />
                  <div className="flex justify-center mt-6">
                    {answers[currentQuestions[currentQuestionIndex].id] && ( // Only show next button if an answer is selected
                      <button
                        onClick={nextQuestion}
                        className="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 button-shadow"
                      >
                        {currentQuestionIndex < totalQuestions - 1 ? 'Soalan Seterusnya' : 'Dapatkan Hasil'}
                      </button>
                    )}
                  </div>
                </div>
              )}
            </div>
          );
        };

        // Render the App component into the 'root' div
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
    <footer class="mt-8 text-center text-gray-600 text-sm p-4">
        Laman kuiz ini disediakan oleh Teratak Jamu @ 2025
    </footer>
</body>
</html>
